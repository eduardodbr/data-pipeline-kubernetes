---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: kafka
  namespace: kafka
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: kafka
  chart:
    repository: https://charts.bitnami.com/bitnami
    name: kafka
    version: 10.3.3
    helmVersion: v3
  values:
    metrics:
      kafka:
        enabled: true
      jmx:
        enabled: true
        resources:
          requests:
            cpu:  "50m"
            memory: "100Mi"
          limits:
            cpu:  "100m"
            memory: "250Mi"
      serviceMonitor:
        enabled: true
        namespace: monitoring
        selector:
          release: prometheus-operator #the label that prometheus-operator uses to select the servicemonitor
    #test only
    resources:
      requests:
        cpu:  "200m"
        memory: "250Mi"
      limits:
        cpu:  "250m"
        memory: "1Gi"
    zookeeper:
      metrics:
        enabled: true

  